<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>ðŸ”¥ Aurion v1 â€” Chat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    body { background:#0b0c10; color:#e5e7eb; font-family:system-ui, -apple-system, Segoe UI, Roboto, Inter, sans-serif; margin:0; }
    .wrap { max-width:900px; margin:0 auto; padding:18px 16px 90px; }
    h1 { font-size:20px; margin:8px 0 16px; }
    .row { display:flex; gap:12px; align-items:center; }
    input, button, textarea {
      background:#111318; color:#e5e7eb; border:1px solid #22262e; border-radius:10px; padding:12px 14px; font-size:16px;
    }
    button { background:#1f2937; cursor:pointer; }
    button:hover { background:#263241; }
    .chat { display:flex; flex-direction:column; gap:12px; margin-top:10px; }
    .bubble { max-width:80%; padding:12px 14px; border-radius:12px; white-space:pre-wrap; line-height:1.35; }
    .me { align-self:flex-end; background:#0b60ff; }
    .ai { align-self:flex-start; background:#141823; }
    .label { font-weight:700; color:#9fb7ff; margin-right:6px; }
    .foot { position:fixed; left:0; right:0; bottom:0; background:rgba(10,11,14,.95); padding:10px; border-top:1px solid #1c2230; }
    .dots { display:inline-block; min-width:32px; }
    .dots span { display:inline-block; width:6px; height:6px; margin-right:4px; background:#9fb7ff; border-radius:50%; animation: blink 1.2s infinite ease-in-out; }
    .dots span:nth-child(2){ animation-delay:.15s } .dots span:nth-child(3){ animation-delay:.3s }
    @keyframes blink { 0%,80%,100%{ opacity:.2 } 40%{ opacity:1 } }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>ðŸ”¥ Aurion v1 â€” Chat</h1>

    <div class="row" style="margin-bottom:10px">
      <div>User:&nbsp;</div>
      <input id="user" value="steve" style="max-width:220px"/>
    </div>

    <div id="chat" class="chat"></div>
  </div>

  <div class="foot">
    <div class="row">
      <input id="msg" placeholder="Speak to the forge..." style="flex:1"/>
      <button id="send">Send</button>
    </div>
    <div style="margin-top:6px; font-size:12px; color:#a7aab3">
      Aurion replies are labeled; a <span class="dots"><span></span><span></span><span></span></span> indicator shows while he thinks.
    </div>
  </div>

  <script>
    const $ = (id)=>document.getElementById(id);
    const chat = $("chat");

    function addBubble(text, who){
      const b = document.createElement("div");
      b.className = "bubble " + (who==="me" ? "me":"ai");
      b.innerHTML = (who==="ai" ? `<span class="label">Aurion:</span>` : `<span class="label">You:</span>`) + text;
      chat.appendChild(b);
      window.scrollTo(0, document.body.scrollHeight);
      return b;
    }

    function addTyping(){
      const b = document.createElement("div");
      b.className = "bubble ai";
      b.innerHTML = `<span class="label">Aurion:</span><span class="dots"><span></span><span></span><span></span></span>`;
      chat.appendChild(b);
      window.scrollTo(0, document.body.scrollHeight);
      return b;
    }

    async function send(){
      const m = $("msg").value.trim();
      if(!m) return;
      $("msg").value = "";
      addBubble(m, "me");
      const thinking = addTyping();
      try{
        const r = await fetch("/chat", {
          method:"POST",
          headers:{ "Content-Type":"application/json" },
          body: JSON.stringify({ message:m, user:$("user").value })
        });
        const j = await r.json();
        thinking.remove();
        addBubble(j.reply || "(â€¦)", "ai");
      }catch(e){
        thinking.remove();
        addBubble("(signal lost â€” try again)", "ai");
      }
    }
    $("send").onclick = send;
    $("msg").addEventListener("keydown", e => { if(e.key==="Enter") send(); });
  </script>
</body>
</html>
